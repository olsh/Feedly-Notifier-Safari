(function(q){(function(u,r){"object"===typeof exports&&exports?module.exports=r:"function"===typeof define&&define.amd?define(r):u.Mustache=r})(this,function(){function u(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(a){this.tail=this.string=a;this.pos=0}function g(a,b){this.view=a;this.parent=b;this.clearCache()}function k(){this.clearCache()}function q(a){function b(a,b,h){if(!c[a]){var e=q(b);c[a]=function(a,b){return e(a,b,h)}}return c[a]}var c={};return function(c,f,h){for(var e=
"",m,l,p=0,n=a.length;p<n;++p)switch(m=a[p],m[0]){case "#":l=h.slice(m[3],m[5]);e+=c._section(m[1],f,l,b(p,m[4],h));break;case "^":e+=c._inverted(m[1],f,b(p,m[4],h));break;case ">":e+=c._partial(m[1],f);break;case "&":e+=c._name(m[1],f);break;case "name":e+=c._escaped(m[1],f);break;case "text":e+=m[1]}return e}}function x(a){return[RegExp(u(a[0])+"\\s*"),RegExp("\\s*"+u(a[1]))]}var l={name:"mustache.js",version:"0.7.2",tags:["{{","}}"]};l.Scanner=r;l.Context=g;l.Writer=k;var B=/\s*/,y=/\s+/,C=/\S/,
z=/\s*=/,D=/\s*\}/,E=/#|\^|\/|>|\{|&|=|!/,A=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};l.escape=function(a){return String(a).replace(/[&<>"'\/]/g,function(a){return F[a]})};r.prototype.eos=function(){return""===this.tail};r.prototype.scan=function(a){return(a=this.tail.match(a))&&0===a.index?(this.tail=this.tail.substring(a[0].length),this.pos+=a[0].length,a[0]):""};r.prototype.scanUntil=
function(a){var b=this.tail.search(a);switch(b){case -1:a=this.tail;this.pos+=this.tail.length;this.tail="";break;case 0:a="";break;default:a=this.tail.substring(0,b),this.tail=this.tail.substring(b),this.pos+=b}return a};g.make=function(a){return a instanceof g?a:new g(a)};g.prototype.clearCache=function(){this._cache={}};g.prototype.push=function(a){return new g(a,this)};g.prototype.lookup=function(a){var b=this._cache[a];if(!b){if("."===a)b=this.view;else for(var c=this;c;){if(0<a.indexOf("."))for(var d=
a.split("."),f=0,b=c.view;b&&f<d.length;)b=b[d[f++]];else b=c.view[a];if(null!=b)break;c=c.parent}this._cache[a]=b}"function"===typeof b&&(b=b.call(this.view));return b};k.prototype.clearCache=function(){this._cache={};this._partialCache={}};k.prototype.compile=function(a,b){var c=this._cache[a];c||(c=l.parse(a,b),c=this._cache[a]=this.compileTokens(c,a));return c};k.prototype.compilePartial=function(a,b,c){b=this.compile(b,c);return this._partialCache[a]=b};k.prototype.compileTokens=function(a,b){var c=
q(a),d=this;return function(a,h){if(h)if("function"===typeof h)d._loadPartial=h;else for(var e in h)d.compilePartial(e,h[e]);return c(d,g.make(a),b)}};k.prototype.render=function(a,b,c){return this.compile(a)(b,c)};k.prototype._section=function(a,b,c,d){a=b.lookup(a);switch(typeof a){case "object":if(A(a)){c="";for(var f=0,h=a.length;f<h;++f)c+=d(this,b.push(a[f]));return c}return a?d(this,b.push(a)):"";case "function":var e=this;d=a.call(b.view,c,function(a){return e.render(a,b)});return null!=d?
d:"";default:if(a)return d(this,b)}return""};k.prototype._inverted=function(a,b,c){a=b.lookup(a);return!a||A(a)&&0===a.length?c(this,b):""};k.prototype._partial=function(a,b){a in this._partialCache||!this._loadPartial||this.compilePartial(a,this._loadPartial(a));var c=this._partialCache[a];return c?c(b):""};k.prototype._name=function(a,b){var c=b.lookup(a);"function"===typeof c&&(c=c.call(b.view));return null==c?"":String(c)};k.prototype._escaped=function(a,b){return l.escape(this._name(a,b))};l.parse=
function(a,b){a=a||"";b=b||l.tags;"string"===typeof b&&(b=b.split(y));if(2!==b.length)throw Error("Invalid tags: "+b.join(", "));for(var c=x(b),d=new r(a),f=[],h=[],e=[],m=!1,k=!1,p,n,g;!d.eos();){p=d.pos;if(g=d.scanUntil(c[0]))for(var s=0,q=g.length;s<q;++s)if(n=g.charAt(s),RegExp.prototype.test.call(C,n)?k=!0:e.push(h.length),h.push(["text",n,p,p+1]),p+=1,"\n"===n){if(m&&!k)for(;e.length;)h.splice(e.pop(),1);else e=[];k=m=!1}p=d.pos;if(!d.scan(c[0]))break;m=!0;n=d.scan(E)||"name";d.scan(B);"="===
n?(g=d.scanUntil(z),d.scan(z),d.scanUntil(c[1])):"{"===n?(g=RegExp("\\s*"+u("}"+b[1])),g=d.scanUntil(g),d.scan(D),d.scanUntil(c[1]),n="&"):g=d.scanUntil(c[1]);if(!d.scan(c[1]))throw Error("Unclosed tag at "+d.pos);if("/"===n){if(0===f.length)throw Error('Unopened section "'+g+'" at '+p);s=f.pop();if(s[1]!==g)throw Error('Unclosed section "'+s[1]+'" at '+p);}s=[n,g,p,d.pos];h.push(s);if("#"===n||"^"===n)f.push(s);else if("name"===n||"{"===n||"&"===n)k=!0;else if("="===n){b=g.split(y);if(2!==b.length)throw Error("Invalid tags at "+
p+": "+b.join(", "));c=x(b)}}if(s=f.pop())throw Error('Unclosed section "'+s[1]+'" at '+d.pos);for(var c=[],t,f=0,e=h.length;f<e;++f)d=h[f],"text"===d[0]&&t&&"text"===t[0]?(t[1]+=d[1],t[3]=d[3]):(t=d,c.push(d));t=h=[];d=[];e=0;for(m=c.length;e<m;++e)switch(f=c[e],f[0]){case "#":case "^":d.push(f);t.push(f);t=f[4]=[];break;case "/":d.pop()[5]=f[2];t=0<d.length?d[d.length-1][4]:h;break;default:t.push(f)}return h};var v=new k;l.clearCache=function(){return v.clearCache()};l.compile=function(a,b){return v.compile(a,
b)};l.compilePartial=function(a,b,c){return v.compilePartial(a,b,c)};l.compileTokens=function(a,b){return v.compileTokens(a,b)};l.render=function(a,b,c){return v.render(a,b,c)};l.to_html=function(a,b,c,d){a=l.render(a,b,c);if("function"===typeof d)d(a);else return a};return l}());q.mustache=function(q,r,g){return Mustache.render(q,r,g)};q.fn.mustache=function(u,r){return q(this).map(function(g,k){var w=q(k).html().trim(),w=q.mustache(w,u,r);return q(w).get()})}})(jQuery);
